<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ä½¿ç”¨Claude Codeæ„å»ºRESTful APIå®Œå…¨æŒ‡å— - ä»é›¶å¼€å§‹ç”¨AIè¾…åŠ©å¼€å‘é«˜è´¨é‡çš„API">
    <meta name="keywords" content="Claude Code, REST API, APIå¼€å‘, FastAPI, Flask, Webå¼€å‘, AIç¼–ç¨‹">

    <!-- Open Graph -->
    <meta property="og:title" content="ä½¿ç”¨ Claude Code æ„å»º RESTful API - Claude Code Club">
    <meta property="og:description" content="å­¦ä¹ å¦‚ä½•ç”¨Claude Codeé«˜æ•ˆå¼€å‘RESTful API">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://ccclub.club/tutorials/claude-code-rest-api.html">
    <meta property="og:image" content="https://ccclub.club/assets/og-image.png">
    <meta property="og:site_name" content="Claude Code Club">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ä½¿ç”¨ Claude Code æ„å»º RESTful API">
    <meta name="twitter:description" content="å­¦ä¹ å¦‚ä½•ç”¨Claude Codeé«˜æ•ˆå¼€å‘RESTful API">
    <meta name="twitter:image" content="https://ccclub.club/assets/og-image.png">

    <!-- å¾®ä¿¡åˆ†äº«ä¼˜åŒ– -->
    <meta itemprop="name" content="ä½¿ç”¨ Claude Code æ„å»º RESTful API">
    <meta itemprop="description" content="å­¦ä¹ å¦‚ä½•ç”¨Claude Codeé«˜æ•ˆå¼€å‘RESTful API">
    <meta itemprop="image" content="https://ccclub.club/assets/og-image.png">

    <title>ä½¿ç”¨ Claude Code æ„å»º RESTful API - Claude Code Club</title>
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/tutorial.css">
    <link rel="canonical" href="https://ccclub.club/tutorials/claude-code-rest-api.html">
</head>

<body>
    <header class="header">
        <nav class="nav">
            <div class="nav-container">
                <a href="../" class="logo">
                    <img src="../assets/logo-simple.png" alt="Claude Code Club" class="logo-img">
                </a>
                <ul class="nav-menu">
                    <li><a href="../#home">é¦–é¡µ</a></li>
                    <li><a href="../#tutorials">æ•™ç¨‹</a></li>
                    <li><a href="../#examples">ç¤ºä¾‹</a></li>
                    <li><a href="../community.html">ç¤¾åŒº</a></li>
                    <li><a href="../about.html">å…³äº</a></li>
                    <li><a href="../subscription.html">è®¢é˜…</a></li>
                </ul>
                            <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </nav>
    </header>

    <main class="tutorial-content">
        <div class="container">
            <article class="tutorial-article">
                <header class="tutorial-header">
                    <h1>ä½¿ç”¨ Claude Code æ„å»º RESTful API</h1>
                    <div class="tutorial-meta">
                        <span class="difficulty">ä¸­çº§</span>
                        <span class="duration">50åˆ†é’Ÿ</span>
                        <span class="updated">æ›´æ–°æ—¶é—´: 2024å¹´11æœˆ</span>
                    </div>
                </header>

                <div class="tutorial-toc">
                    <h3>ç›®å½•</h3>
                    <ul>
                        <li><a href="#introduction">RESTful API åŸºç¡€</a></li>
                        <li><a href="#framework-choice">é€‰æ‹©åˆé€‚çš„æ¡†æ¶</a></li>
                        <li><a href="#project-setup">é¡¹ç›®åˆå§‹åŒ–</a></li>
                        <li><a href="#build-api">æ„å»º API ç«¯ç‚¹</a></li>
                        <li><a href="#authentication">èº«ä»½éªŒè¯</a></li>
                        <li><a href="#testing">API æµ‹è¯•</a></li>
                        <li><a href="#deployment">éƒ¨ç½²ä¸Šçº¿</a></li>
                    </ul>
                </div>

                <section id="introduction">
                    <h2>ğŸ¯ RESTful API åŸºç¡€</h2>
                    <p>RESTful API æ˜¯ç°ä»£Webåº”ç”¨çš„æ ¸å¿ƒã€‚ä½¿ç”¨ Claude Codeï¼Œä½ å¯ä»¥ï¼š</p>
                    <ul>
                        <li><strong>å¿«é€Ÿç”Ÿæˆä»£ç </strong>ï¼šè‡ªåŠ¨ç”Ÿæˆè·¯ç”±ã€æ§åˆ¶å™¨ã€æ¨¡å‹</li>
                        <li><strong>éµå¾ªæœ€ä½³å®è·µ</strong>ï¼šä»£ç ç¬¦åˆRESTè§„èŒƒå’Œå®‰å…¨æ ‡å‡†</li>
                        <li><strong>è‡ªåŠ¨åŒ–æ–‡æ¡£</strong>ï¼šç”ŸæˆAPIæ–‡æ¡£å’Œæµ‹è¯•ç”¨ä¾‹</li>
                        <li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯å“åº”</li>
                    </ul>

                    <div class="tip-box">
                        <h4>RESTful API æ ¸å¿ƒåŸåˆ™ï¼š</h4>
                        <ul>
                            <li><strong>èµ„æºå¯¼å‘</strong>ï¼šä¸€åˆ‡çš†èµ„æºï¼ˆç”¨æˆ·ã€æ–‡ç« ã€å•†å“ç­‰ï¼‰</li>
                            <li><strong>HTTP æ–¹æ³•</strong>ï¼šGETï¼ˆè·å–ï¼‰ã€POSTï¼ˆåˆ›å»ºï¼‰ã€PUTï¼ˆæ›´æ–°ï¼‰ã€DELETEï¼ˆåˆ é™¤ï¼‰</li>
                            <li><strong>æ— çŠ¶æ€</strong>ï¼šæ¯ä¸ªè¯·æ±‚åŒ…å«æ‰€æœ‰å¿…è¦ä¿¡æ¯</li>
                            <li><strong>ç»Ÿä¸€æ¥å£</strong>ï¼šä¸€è‡´çš„URLç»“æ„å’Œå“åº”æ ¼å¼</li>
                        </ul>
                    </div>
                </section>

                <section id="framework-choice">
                    <h2>ğŸ› ï¸ é€‰æ‹©åˆé€‚çš„æ¡†æ¶</h2>

                    <h3>Python æ¡†æ¶å¯¹æ¯”</h3>
                    <div class="code-block">
                        <h4>è®© Claude å¸®ä½ é€‰æ‹©æ¡†æ¶ï¼š</h4>
                        <pre>
ä½ ï¼šæˆ‘è¦å¼€å‘ä¸€ä¸ªç”¨æˆ·ç®¡ç†APIï¼Œåº”è¯¥é€‰æ‹©å“ªä¸ªPythonæ¡†æ¶ï¼Ÿ

Claude çš„å»ºè®®ï¼š

1. **FastAPI** (æ¨è)
   ä¼˜ç‚¹ï¼š
   - ç°ä»£åŒ–ã€æ€§èƒ½ä¼˜å¼‚
   - è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£ï¼ˆSwagger UIï¼‰
   - ç±»å‹æç¤ºå’Œæ•°æ®éªŒè¯
   - å¼‚æ­¥æ”¯æŒ

   é€‚ç”¨åœºæ™¯ï¼šæ–°é¡¹ç›®ã€é«˜æ€§èƒ½éœ€æ±‚ã€éœ€è¦è‡ªåŠ¨æ–‡æ¡£

2. **Flask**
   ä¼˜ç‚¹ï¼š
   - è½»é‡çº§ã€çµæ´»
   - ç”Ÿæ€ç³»ç»Ÿæˆç†Ÿ
   - å­¦ä¹ æ›²çº¿å¹³ç¼“

   é€‚ç”¨åœºæ™¯ï¼šç®€å•APIã€å¿«é€ŸåŸå‹ã€å®Œå…¨æ§åˆ¶

3. **Django REST Framework**
   ä¼˜ç‚¹ï¼š
   - åŠŸèƒ½å…¨é¢
   - å†…ç½®ORMå’Œç®¡ç†åå°
   - ä¼ä¸šçº§ç‰¹æ€§

   é€‚ç”¨åœºæ™¯ï¼šå¤§å‹é¡¹ç›®ã€éœ€è¦ç®¡ç†åå°ã€æ•°æ®åº“æ“ä½œå¤š

æœ¬æ•™ç¨‹ä½¿ç”¨ FastAPI æ¼”ç¤º</pre>
                    </div>
                </section>

                <section id="project-setup">
                    <h2>ğŸš€ é¡¹ç›®åˆå§‹åŒ–</h2>

                    <h3>1. è®© Claude åˆ›å»ºé¡¹ç›®ç»“æ„</h3>
                    <div class="code-block">
                        <h4>æç¤ºè¯ï¼š</h4>
                        <pre>
ä½ ï¼šå¸®æˆ‘åˆ›å»ºä¸€ä¸ªFastAPIé¡¹ç›®ç»“æ„ï¼Œç”¨äºç”¨æˆ·ç®¡ç†ç³»ç»Ÿ

Claude ç”Ÿæˆï¼š
project/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py          # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ models.py        # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ schemas.py       # Pydanticæ¨¡å¼
â”‚   â”œâ”€â”€ crud.py          # æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ database.py      # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ routers/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ users.py     # ç”¨æˆ·è·¯ç”±
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_users.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .env
â””â”€â”€ README.md</pre>
                    </div>

                    <h3>2. å®‰è£…ä¾èµ–</h3>
                    <div class="code-block">
                        <h4>requirements.txtï¼š</h4>
                        <pre>
fastapi==0.104.1
uvicorn[standard]==0.24.0
sqlalchemy==2.0.23
pydantic==2.5.0
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
python-multipart==0.0.6
pytest==7.4.3
httpx==0.25.2</pre>
                    </div>
                </section>

                <section id="build-api">
                    <h2>ğŸ“ æ„å»º API ç«¯ç‚¹</h2>

                    <h3>1. å®šä¹‰æ•°æ®æ¨¡å‹</h3>
                    <div class="code-block">
                        <h4>è®© Claude ç”Ÿæˆæ¨¡å‹ä»£ç ï¼š</h4>
                        <pre>
ä½ ï¼šåˆ›å»ºç”¨æˆ·æ¨¡å‹ï¼ŒåŒ…å«IDã€ç”¨æˆ·åã€é‚®ç®±ã€å¯†ç å“ˆå¸Œã€åˆ›å»ºæ—¶é—´

# models.py
from sqlalchemy import Column, Integer, String, DateTime
from sqlalchemy.sql import func
from .database import Base

class User(Base):
    __tablename__ = "users"

    id = Column(Integer, primary_key=True, index=True)
    username = Column(String, unique=True, index=True, nullable=False)
    email = Column(String, unique=True, index=True, nullable=False)
    hashed_password = Column(String, nullable=False)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())</pre>
                    </div>

                    <h3>2. åˆ›å»º Pydantic Schema</h3>
                    <div class="code-block">
                        <h4>schemas.pyï¼š</h4>
                        <pre>
from pydantic import BaseModel, EmailStr
from datetime import datetime
from typing import Optional

class UserBase(BaseModel):
    username: str
    email: EmailStr

class UserCreate(UserBase):
    password: str

class UserUpdate(BaseModel):
    username: Optional[str] = None
    email: Optional[EmailStr] = None
    password: Optional[str] = None

class UserResponse(UserBase):
    id: int
    created_at: datetime

    class Config:
        from_attributes = True</pre>
                    </div>

                    <h3>3. å®ç° CRUD æ“ä½œ</h3>
                    <div class="code-block">
                        <h4>è®© Claude ç”Ÿæˆ CRUD å‡½æ•°ï¼š</h4>
                        <pre>
# crud.py
from sqlalchemy.orm import Session
from . import models, schemas
from passlib.context import CryptContext

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

def get_user(db: Session, user_id: int):
    return db.query(models.User).filter(models.User.id == user_id).first()

def get_user_by_email(db: Session, email: str):
    return db.query(models.User).filter(models.User.email == email).first()

def get_users(db: Session, skip: int = 0, limit: int = 100):
    return db.query(models.User).offset(skip).limit(limit).all()

def create_user(db: Session, user: schemas.UserCreate):
    hashed_password = pwd_context.hash(user.password)
    db_user = models.User(
        username=user.username,
        email=user.email,
        hashed_password=hashed_password
    )
    db.add(db_user)
    db.commit()
    db.refresh(db_user)
    return db_user

def update_user(db: Session, user_id: int, user: schemas.UserUpdate):
    db_user = get_user(db, user_id)
    if not db_user:
        return None

    update_data = user.model_dump(exclude_unset=True)
    if "password" in update_data:
        update_data["hashed_password"] = pwd_context.hash(update_data.pop("password"))

    for field, value in update_data.items():
        setattr(db_user, field, value)

    db.commit()
    db.refresh(db_user)
    return db_user

def delete_user(db: Session, user_id: int):
    db_user = get_user(db, user_id)
    if db_user:
        db.delete(db_user)
        db.commit()
        return True
    return False</pre>
                    </div>

                    <h3>4. åˆ›å»º API è·¯ç”±</h3>
                    <div class="code-block">
                        <h4>routers/users.pyï¼š</h4>
                        <pre>
from fastapi import APIRouter, Depends, HTTPException, status
from sqlalchemy.orm import Session
from typing import List
from .. import crud, schemas
from ..database import get_db

router = APIRouter(prefix="/users", tags=["users"])

@router.post("/", response_model=schemas.UserResponse, status_code=status.HTTP_201_CREATED)
def create_user(user: schemas.UserCreate, db: Session = Depends(get_db)):
    """åˆ›å»ºæ–°ç”¨æˆ·"""
    db_user = crud.get_user_by_email(db, email=user.email)
    if db_user:
        raise HTTPException(
            status_code=400,
            detail="Email already registered"
        )
    return crud.create_user(db=db, user=user)

@router.get("/", response_model=List[schemas.UserResponse])
def read_users(skip: int = 0, limit: int = 100, db: Session = Depends(get_db)):
    """è·å–ç”¨æˆ·åˆ—è¡¨"""
    users = crud.get_users(db, skip=skip, limit=limit)
    return users

@router.get("/{user_id}", response_model=schemas.UserResponse)
def read_user(user_id: int, db: Session = Depends(get_db)):
    """è·å–å•ä¸ªç”¨æˆ·"""
    db_user = crud.get_user(db, user_id=user_id)
    if db_user is None:
        raise HTTPException(status_code=404, detail="User not found")
    return db_user

@router.put("/{user_id}", response_model=schemas.UserResponse)
def update_user(user_id: int, user: schemas.UserUpdate, db: Session = Depends(get_db)):
    """æ›´æ–°ç”¨æˆ·ä¿¡æ¯"""
    db_user = crud.update_user(db, user_id=user_id, user=user)
    if db_user is None:
        raise HTTPException(status_code=404, detail="User not found")
    return db_user

@router.delete("/{user_id}", status_code=status.HTTP_204_NO_CONTENT)
def delete_user(user_id: int, db: Session = Depends(get_db)):
    """åˆ é™¤ç”¨æˆ·"""
    success = crud.delete_user(db, user_id=user_id)
    if not success:
        raise HTTPException(status_code=404, detail="User not found")
    return None</pre>
                    </div>
                </section>

                <section id="authentication">
                    <h2>ğŸ” èº«ä»½éªŒè¯</h2>

                    <h3>å®ç° JWT è®¤è¯</h3>
                    <div class="code-block">
                        <h4>è®© Claude æ·»åŠ è®¤è¯åŠŸèƒ½ï¼š</h4>
                        <pre>
ä½ ï¼šä¸ºAPIæ·»åŠ JWTè®¤è¯

# auth.py
from datetime import datetime, timedelta
from jose import JWTError, jwt
from fastapi import Depends, HTTPException, status
from fastapi.security import OAuth2PasswordBearer
from sqlalchemy.orm import Session

SECRET_KEY = "your-secret-key-here"  # åº”è¯¥ä»ç¯å¢ƒå˜é‡è¯»å–
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30

oauth2_scheme = OAuth2PasswordBearer(tokenUrl="token")

def create_access_token(data: dict):
    to_encode = data.copy()
    expire = datetime.utcnow() + timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
    return encoded_jwt

def get_current_user(token: str = Depends(oauth2_scheme), db: Session = Depends(get_db)):
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": "Bearer"},
    )
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        user_id: int = payload.get("sub")
        if user_id is None:
            raise credentials_exception
    except JWTError:
        raise credentials_exception

    user = crud.get_user(db, user_id=user_id)
    if user is None:
        raise credentials_exception
    return user</pre>
                    </div>
                </section>

                <section id="testing">
                    <h2>ğŸ§ª API æµ‹è¯•</h2>

                    <div class="code-block">
                        <h4>è®© Claude ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ï¼š</h4>
                        <pre>
# tests/test_users.py
from fastapi.testclient import TestClient
from app.main import app

client = TestClient(app)

def test_create_user():
    response = client.post(
        "/users/",
        json={
            "username": "testuser",
            "email": "test@example.com",
            "password": "testpass123"
        }
    )
    assert response.status_code == 201
    data = response.json()
    assert data["username"] == "testuser"
    assert data["email"] == "test@example.com"
    assert "id" in data

def test_read_users():
    response = client.get("/users/")
    assert response.status_code == 200
    assert isinstance(response.json(), list)

def test_read_user():
    # å…ˆåˆ›å»ºç”¨æˆ·
    create_response = client.post(
        "/users/",
        json={
            "username": "testuser2",
            "email": "test2@example.com",
            "password": "testpass123"
        }
    )
    user_id = create_response.json()["id"]

    # è¯»å–ç”¨æˆ·
    response = client.get(f"/users/{user_id}")
    assert response.status_code == 200
    data = response.json()
    assert data["id"] == user_id

def test_user_not_found():
    response = client.get("/users/99999")
    assert response.status_code == 404</pre>
                    </div>
                </section>

                <section id="deployment">
                    <h2>ğŸš€ éƒ¨ç½²ä¸Šçº¿</h2>

                    <div class="tip-box">
                        <h4>éƒ¨ç½²é€‰é¡¹ï¼š</h4>
                        <ul>
                            <li><strong>Docker</strong>ï¼šå®¹å™¨åŒ–éƒ¨ç½²ï¼Œä¸€è‡´çš„è¿è¡Œç¯å¢ƒ</li>
                            <li><strong>äº‘å¹³å°</strong>ï¼šAWS, Azure, Google Cloud</li>
                            <li><strong>Vercel/Railway</strong>ï¼šå¿«é€Ÿéƒ¨ç½²Pythonåº”ç”¨</li>
                            <li><strong>è‡ªå»ºæœåŠ¡å™¨</strong>ï¼šä½¿ç”¨Nginx + Gunicorn/Uvicorn</li>
                        </ul>
                    </div>

                    <div class="code-block">
                        <h4>Dockerfile ç¤ºä¾‹ï¼š</h4>
                        <pre>
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]</pre>
                    </div>
                </section>

                <section class="next-steps">
                    <h2>ğŸš€ ä¸‹ä¸€æ­¥</h2>
                    <p>ç»§ç»­æ·±å…¥å­¦ä¹ ï¼š</p>
                    <ul>
                        <li><a href="claude-code-testing.html">APIè‡ªåŠ¨åŒ–æµ‹è¯•</a></li>
                        <li><a href="claude-code-security.html">APIå®‰å…¨æœ€ä½³å®è·µ</a></li>
                        <li><a href="claude-code-performance.html">APIæ€§èƒ½ä¼˜åŒ–</a></li>
                    </ul>
                </section>
            </article>
        </div>
    </main>

    <div id="footer-placeholder"></div>

    <script src="../scripts/load-footer.js"></script>
    <script src="../scripts/wechat-share.js"></script>
</body>

</html>
