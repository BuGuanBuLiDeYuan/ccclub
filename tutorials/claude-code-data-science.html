<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Claude Codeæ•°æ®ç§‘å­¦å®æˆ˜ - ç”¨AIè¾…åŠ©è¿›è¡Œæ•°æ®åˆ†æã€æœºå™¨å­¦ä¹ å’Œå¯è§†åŒ–">
    <meta name="keywords" content="Claude Code, æ•°æ®ç§‘å­¦, æœºå™¨å­¦ä¹ , æ•°æ®åˆ†æ, Python, Pandas, NumPy, AIç¼–ç¨‹">

    <!-- Open Graph -->
    <meta property="og:title" content="Claude Code æ•°æ®ç§‘å­¦å®æˆ˜æŒ‡å— - Claude Code Club">
    <meta property="og:description" content="å­¦ä¹ å¦‚ä½•ç”¨Claude Codeè¿›è¡Œæ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ ">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://ccclub.club/tutorials/claude-code-data-science.html">
    <meta property="og:image" content="https://ccclub.club/assets/og-image.png">
    <meta property="og:site_name" content="Claude Code Club">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Claude Code æ•°æ®ç§‘å­¦å®æˆ˜æŒ‡å—">
    <meta name="twitter:description" content="å­¦ä¹ å¦‚ä½•ç”¨Claude Codeè¿›è¡Œæ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ ">
    <meta name="twitter:image" content="https://ccclub.club/assets/og-image.png">

    <!-- å¾®ä¿¡åˆ†äº«ä¼˜åŒ– -->
    <meta itemprop="name" content="Claude Code æ•°æ®ç§‘å­¦å®æˆ˜æŒ‡å—">
    <meta itemprop="description" content="å­¦ä¹ å¦‚ä½•ç”¨Claude Codeè¿›è¡Œæ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ ">
    <meta itemprop="image" content="https://ccclub.club/assets/og-image.png">

    <title>Claude Code æ•°æ®ç§‘å­¦å®æˆ˜æŒ‡å— - Claude Code Club</title>
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/tutorial.css">
    <link rel="canonical" href="https://ccclub.club/tutorials/claude-code-data-science.html">
</head>

<body>
    <header class="header">
        <nav class="nav">
            <div class="nav-container">
                <a href="../" class="logo">
                    <img src="../assets/logo-simple.png" alt="Claude Code Club" class="logo-img">
                </a>
                <ul class="nav-menu">
                    <li><a href="../#home">é¦–é¡µ</a></li>
                    <li><a href="../#tutorials">æ•™ç¨‹</a></li>
                    <li><a href="../#examples">ç¤ºä¾‹</a></li>
                    <li><a href="../community.html">ç¤¾åŒº</a></li>
                    <li><a href="../about.html">å…³äº</a></li>
                    <li><a href="../subscription.html">è®¢é˜…</a></li>
                </ul>
                            <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </nav>
    </header>

    <main class="tutorial-content">
        <div class="container">
            <article class="tutorial-article">
                <header class="tutorial-header">
                    <h1>Claude Code æ•°æ®ç§‘å­¦å®æˆ˜æŒ‡å—</h1>
                    <div class="tutorial-meta">
                        <span class="difficulty">ä¸­çº§</span>
                        <span class="duration">45åˆ†é’Ÿ</span>
                        <span class="updated">æ›´æ–°æ—¶é—´: 2024å¹´11æœˆ</span>
                    </div>
                </header>

                <div class="tutorial-toc">
                    <h3>ç›®å½•</h3>
                    <ul>
                        <li><a href="#introduction">æ•°æ®ç§‘å­¦ä¸AIç»“åˆ</a></li>
                        <li><a href="#data-cleaning">æ•°æ®æ¸…æ´—</a></li>
                        <li><a href="#data-analysis">æ•°æ®åˆ†æ</a></li>
                        <li><a href="#visualization">æ•°æ®å¯è§†åŒ–</a></li>
                        <li><a href="#machine-learning">æœºå™¨å­¦ä¹ å…¥é—¨</a></li>
                        <li><a href="#advanced-ml">é«˜çº§MLåº”ç”¨</a></li>
                        <li><a href="#best-practices">æœ€ä½³å®è·µ</a></li>
                    </ul>
                </div>

                <section id="introduction">
                    <h2>ğŸ¯ æ•°æ®ç§‘å­¦ä¸AIç»“åˆ</h2>
                    <p>Claude Code è®©æ•°æ®ç§‘å­¦å·¥ä½œæ›´é«˜æ•ˆï¼š</p>
                    <ul>
                        <li><strong>ä»£ç ç”Ÿæˆ</strong>ï¼šå¿«é€Ÿç”Ÿæˆæ•°æ®å¤„ç†å’Œåˆ†æä»£ç </li>
                        <li><strong>é”™è¯¯ä¿®å¤</strong>ï¼šAIå¸®ä½ è¯Šæ–­å’Œä¿®å¤æ•°æ®é—®é¢˜</li>
                        <li><strong>æœ€ä½³å®è·µ</strong>ï¼šéµå¾ªæ•°æ®ç§‘å­¦æ ‡å‡†æµç¨‹</li>
                        <li><strong>æ–‡æ¡£ç”Ÿæˆ</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆåˆ†ææŠ¥å‘Šå’Œæ³¨é‡Š</li>
                        <li><strong>å­¦ä¹ è¾…åŠ©</strong>ï¼šè§£é‡Šå¤æ‚çš„ç®—æ³•å’Œæ¦‚å¿µ</li>
                    </ul>

                    <div class="tip-box">
                        <h4>å¿…å¤‡å·¥å…·åŒ…ï¼š</h4>
                        <ul>
                            <li><strong>NumPy</strong>ï¼šæ•°å€¼è®¡ç®—</li>
                            <li><strong>Pandas</strong>ï¼šæ•°æ®å¤„ç†</li>
                            <li><strong>Matplotlib/Seaborn</strong>ï¼šæ•°æ®å¯è§†åŒ–</li>
                            <li><strong>Scikit-learn</strong>ï¼šæœºå™¨å­¦ä¹ </li>
                            <li><strong>Jupyter</strong>ï¼šäº¤äº’å¼å¼€å‘ç¯å¢ƒ</li>
                        </ul>
                    </div>
                </section>

                <section id="data-cleaning">
                    <h2>ğŸ§¹ æ•°æ®æ¸…æ´—</h2>

                    <h3>1. å¤„ç†ç¼ºå¤±å€¼</h3>
                    <div class="code-block">
                        <h4>è®© Claude å¸®ä½ æ¸…æ´—æ•°æ®ï¼š</h4>
                        <pre>
ä½ ï¼šæˆ‘æœ‰ä¸€ä¸ªåŒ…å«ç¼ºå¤±å€¼çš„æ•°æ®é›†ï¼Œå¸®æˆ‘å¤„ç†ä¸€ä¸‹

import pandas as pd
import numpy as np

# è¯»å–æ•°æ®
df = pd.read_csv('data.csv')

# æ£€æŸ¥ç¼ºå¤±å€¼
print("ç¼ºå¤±å€¼ç»Ÿè®¡ï¼š")
print(df.isnull().sum())
print(f"\nç¼ºå¤±å€¼ç™¾åˆ†æ¯”ï¼š")
print(df.isnull().sum() / len(df) * 100)

# Claude å»ºè®®çš„å¤„ç†ç­–ç•¥ï¼š

# ç­–ç•¥1ï¼šåˆ é™¤ç¼ºå¤±å€¼è¿‡å¤šçš„åˆ—ï¼ˆ>50%ï¼‰
threshold = 0.5
df = df.loc[:, df.isnull().mean() < threshold]

# ç­–ç•¥2ï¼šæ•°å€¼åˆ—ç”¨ä¸­ä½æ•°å¡«å……
numeric_columns = df.select_dtypes(include=[np.number]).columns
df[numeric_columns] = df[numeric_columns].fillna(df[numeric_columns].median())

# ç­–ç•¥3ï¼šç±»åˆ«åˆ—ç”¨ä¼—æ•°å¡«å……
categorical_columns = df.select_dtypes(include=['object']).columns
for col in categorical_columns:
    df[col] = df[col].fillna(df[col].mode()[0])

# ç­–ç•¥4ï¼šæ—¶é—´ç›¸å…³çš„å¯ä»¥ç”¨å‰å‘å¡«å……
# df['date_column'] = df['date_column'].fillna(method='ffill')

print("\nå¤„ç†åçš„æ•°æ®ï¼š")
print(df.info())</pre>
                    </div>

                    <h3>2. å¤„ç†å¼‚å¸¸å€¼</h3>
                    <div class="code-block">
                        <h4>è¯†åˆ«å’Œå¤„ç†å¼‚å¸¸å€¼ï¼š</h4>
                        <pre>
ä½ ï¼šå¸®æˆ‘æ£€æµ‹å’Œå¤„ç†æ•°æ®ä¸­çš„å¼‚å¸¸å€¼

import pandas as pd
import numpy as np
from scipy import stats

def detect_outliers(df, column, method='iqr'):
    """æ£€æµ‹å¼‚å¸¸å€¼"""

    if method == 'iqr':
        # IQRæ–¹æ³•ï¼ˆå››åˆ†ä½è·ï¼‰
        Q1 = df[column].quantile(0.25)
        Q3 = df[column].quantile(0.75)
        IQR = Q3 - Q1
        lower_bound = Q1 - 1.5 * IQR
        upper_bound = Q3 + 1.5 * IQR

    elif method == 'zscore':
        # Z-scoreæ–¹æ³•
        z_scores = np.abs(stats.zscore(df[column]))
        threshold = 3
        outliers = z_scores > threshold
        return df[outliers]

    # è¿”å›å¼‚å¸¸å€¼
    outliers = df[(df[column] < lower_bound) | (df[column] > upper_bound)]
    print(f"{column} åˆ—å‘ç° {len(outliers)} ä¸ªå¼‚å¸¸å€¼")
    return outliers

# å¤„ç†å¼‚å¸¸å€¼
def handle_outliers(df, column, method='cap'):
    """å¤„ç†å¼‚å¸¸å€¼"""

    Q1 = df[column].quantile(0.25)
    Q3 = df[column].quantile(0.75)
    IQR = Q3 - Q1
    lower_bound = Q1 - 1.5 * IQR
    upper_bound = Q3 + 1.5 * IQR

    if method == 'cap':
        # ç›–å¸½æ³•ï¼šå°†å¼‚å¸¸å€¼é™åˆ¶åœ¨è¾¹ç•Œ
        df[column] = df[column].clip(lower_bound, upper_bound)
    elif method == 'remove':
        # åˆ é™¤æ³•ï¼šç›´æ¥åˆ é™¤å¼‚å¸¸å€¼è¡Œ
        df = df[(df[column] >= lower_bound) & (df[column] <= upper_bound)]

    return df

# ä½¿ç”¨ç¤ºä¾‹
df = handle_outliers(df, 'age', method='cap')
df = handle_outliers(df, 'income', method='cap')</pre>
                    </div>

                    <h3>3. æ•°æ®ç±»å‹è½¬æ¢</h3>
                    <div class="code-block">
                        <h4>ä¼˜åŒ–æ•°æ®ç±»å‹ï¼š</h4>
                        <pre>
ä½ ï¼šä¼˜åŒ–æ•°æ®æ¡†çš„å†…å­˜ä½¿ç”¨

def optimize_dtypes(df):
    """ä¼˜åŒ–æ•°æ®ç±»å‹ä»¥å‡å°‘å†…å­˜ä½¿ç”¨"""

    # è®°å½•åŸå§‹å†…å­˜ä½¿ç”¨
    start_mem = df.memory_usage().sum() / 1024**2
    print(f'åˆå§‹å†…å­˜ä½¿ç”¨: {start_mem:.2f} MB')

    # ä¼˜åŒ–æ•´æ•°åˆ—
    for col in df.select_dtypes(include=['int']).columns:
        df[col] = pd.to_numeric(df[col], downcast='integer')

    # ä¼˜åŒ–æµ®ç‚¹æ•°åˆ—
    for col in df.select_dtypes(include=['float']).columns:
        df[col] = pd.to_numeric(df[col], downcast='float')

    # å°†é‡å¤æ€§é«˜çš„å­—ç¬¦ä¸²åˆ—è½¬æ¢ä¸ºcategory
    for col in df.select_dtypes(include=['object']).columns:
        num_unique = df[col].nunique()
        num_total = len(df[col])
        if num_unique / num_total < 0.5:  # å¦‚æœå”¯ä¸€å€¼<50%
            df[col] = df[col].astype('category')

    # æ˜¾ç¤ºä¼˜åŒ–åçš„å†…å­˜ä½¿ç”¨
    end_mem = df.memory_usage().sum() / 1024**2
    print(f'ä¼˜åŒ–åå†…å­˜ä½¿ç”¨: {end_mem:.2f} MB')
    print(f'å‡å°‘äº† {100 * (start_mem - end_mem) / start_mem:.1f}%')

    return df

df = optimize_dtypes(df)</pre>
                    </div>
                </section>

                <section id="data-analysis">
                    <h2>ğŸ“Š æ•°æ®åˆ†æ</h2>

                    <h3>1. æ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰</h3>
                    <div class="code-block">
                        <h4>è®© Claude ç”ŸæˆEDAä»£ç ï¼š</h4>
                        <pre>
ä½ ï¼šå¯¹è¿™ä¸ªæ•°æ®é›†è¿›è¡Œå…¨é¢çš„æ¢ç´¢æ€§åˆ†æ

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

def perform_eda(df):
    """æ‰§è¡Œå®Œæ•´çš„æ¢ç´¢æ€§æ•°æ®åˆ†æ"""

    print("="*50)
    print("æ•°æ®é›†åŸºæœ¬ä¿¡æ¯")
    print("="*50)
    print(f"æ•°æ®é›†å½¢çŠ¶: {df.shape}")
    print(f"æ€»è¡Œæ•°: {len(df)}")
    print(f"æ€»åˆ—æ•°: {len(df.columns)}")
    print("\nåˆ—ä¿¡æ¯:")
    print(df.info())

    print("\n" + "="*50)
    print("æ•°å€¼å‹ç‰¹å¾ç»Ÿè®¡")
    print("="*50)
    print(df.describe())

    print("\n" + "="*50)
    print("ç±»åˆ«å‹ç‰¹å¾ç»Ÿè®¡")
    print("="*50)
    categorical_columns = df.select_dtypes(include=['object', 'category']).columns
    for col in categorical_columns:
        print(f"\n{col} çš„å€¼åˆ†å¸ƒ:")
        print(df[col].value_counts())

    print("\n" + "="*50)
    print("ç¼ºå¤±å€¼åˆ†æ")
    print("="*50)
    missing = df.isnull().sum()
    missing_pct = 100 * df.isnull().sum() / len(df)
    missing_table = pd.concat([missing, missing_pct], axis=1)
    missing_table.columns = ['ç¼ºå¤±æ•°é‡', 'ç¼ºå¤±ç™¾åˆ†æ¯”']
    print(missing_table[missing_table['ç¼ºå¤±æ•°é‡'] > 0].sort_values(
        'ç¼ºå¤±ç™¾åˆ†æ¯”', ascending=False))

    print("\n" + "="*50)
    print("ç›¸å…³æ€§åˆ†æ")
    print("="*50)
    numeric_df = df.select_dtypes(include=[np.number])
    correlation_matrix = numeric_df.corr()

    # å¯è§†åŒ–ç›¸å…³æ€§çŸ©é˜µ
    plt.figure(figsize=(12, 10))
    sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm',
                center=0, fmt='.2f', square=True)
    plt.title('ç‰¹å¾ç›¸å…³æ€§çƒ­åŠ›å›¾')
    plt.tight_layout()
    plt.savefig('correlation_matrix.png')
    plt.show()

    return correlation_matrix

# æ‰§è¡ŒEDA
correlation_matrix = perform_eda(df)</pre>
                    </div>

                    <h3>2. ç‰¹å¾å·¥ç¨‹</h3>
                    <div class="code-block">
                        <h4>åˆ›å»ºæ–°ç‰¹å¾ï¼š</h4>
                        <pre>
ä½ ï¼šå¸®æˆ‘å¯¹è¿™äº›ç‰¹å¾è¿›è¡Œå·¥ç¨‹å¤„ç†

from sklearn.preprocessing import StandardScaler, LabelEncoder
from sklearn.feature_selection import SelectKBest, f_classif

# 1. æ ‡å‡†åŒ–æ•°å€¼ç‰¹å¾
scaler = StandardScaler()
numeric_columns = df.select_dtypes(include=[np.number]).columns
df[numeric_columns] = scaler.fit_transform(df[numeric_columns])

# 2. ç¼–ç ç±»åˆ«ç‰¹å¾
label_encoders = {}
for col in df.select_dtypes(include=['object']).columns:
    le = LabelEncoder()
    df[col] = le.fit_transform(df[col].astype(str))
    label_encoders[col] = le

# 3. åˆ›å»ºäº¤äº’ç‰¹å¾
df['age_income_ratio'] = df['age'] / (df['income'] + 1)
df['feature_product'] = df['feature1'] * df['feature2']

# 4. ç‰¹å¾é€‰æ‹©
X = df.drop('target', axis=1)
y = df['target']

selector = SelectKBest(score_func=f_classif, k=10)
X_selected = selector.fit_transform(X, y)

# è·å–è¢«é€‰ä¸­çš„ç‰¹å¾å
selected_features = X.columns[selector.get_support()].tolist()
print(f"é€‰ä¸­çš„ç‰¹å¾: {selected_features}")</pre>
                    </div>
                </section>

                <section id="visualization">
                    <h2>ğŸ“ˆ æ•°æ®å¯è§†åŒ–</h2>

                    <div class="code-block">
                        <h4>è®© Claude åˆ›å»ºç¾è§‚çš„å¯è§†åŒ–ï¼š</h4>
                        <pre>
ä½ ï¼šåˆ›å»ºä¸€å¥—å®Œæ•´çš„æ•°æ®å¯è§†åŒ–

import matplotlib.pyplot as plt
import seaborn as sns

# è®¾ç½®æ ·å¼
sns.set_style("whitegrid")
plt.rcParams['figure.figsize'] = (12, 8)
plt.rcParams['font.size'] = 10

def create_visualizations(df):
    """åˆ›å»ºå®Œæ•´çš„å¯è§†åŒ–å¥—ä»¶"""

    # 1. åˆ†å¸ƒå›¾
    fig, axes = plt.subplots(2, 2, figsize=(15, 12))

    # ç›´æ–¹å›¾
    df['age'].hist(bins=30, ax=axes[0, 0], edgecolor='black')
    axes[0, 0].set_title('å¹´é¾„åˆ†å¸ƒ')
    axes[0, 0].set_xlabel('å¹´é¾„')
    axes[0, 0].set_ylabel('é¢‘æ•°')

    # ç®±çº¿å›¾
    df.boxplot(column='income', by='category', ax=axes[0, 1])
    axes[0, 1].set_title('å„ç±»åˆ«æ”¶å…¥åˆ†å¸ƒ')
    axes[0, 1].set_xlabel('ç±»åˆ«')
    axes[0, 1].set_ylabel('æ”¶å…¥')

    # æ•£ç‚¹å›¾
    axes[1, 0].scatter(df['age'], df['income'], alpha=0.5)
    axes[1, 0].set_title('å¹´é¾„vsæ”¶å…¥')
    axes[1, 0].set_xlabel('å¹´é¾„')
    axes[1, 0].set_ylabel('æ”¶å…¥')

    # é¥¼å›¾
    category_counts = df['category'].value_counts()
    axes[1, 1].pie(category_counts, labels=category_counts.index,
                   autopct='%1.1f%%', startangle=90)
    axes[1, 1].set_title('ç±»åˆ«åˆ†å¸ƒ')

    plt.tight_layout()
    plt.savefig('data_visualizations.png', dpi=300)
    plt.show()

    # 2. é«˜çº§å¯è§†åŒ–ï¼šå°æç´å›¾
    plt.figure(figsize=(12, 6))
    sns.violinplot(data=df, x='category', y='income', hue='gender')
    plt.title('æ”¶å…¥åˆ†å¸ƒï¼ˆæŒ‰ç±»åˆ«å’Œæ€§åˆ«ï¼‰')
    plt.xticks(rotation=45)
    plt.tight_layout()
    plt.savefig('violin_plot.png', dpi=300)
    plt.show()

    # 3. æ—¶é—´åºåˆ—å›¾ï¼ˆå¦‚æœæœ‰æ—¥æœŸåˆ—ï¼‰
    if 'date' in df.columns:
        plt.figure(figsize=(15, 6))
        df.groupby('date')['value'].mean().plot()
        plt.title('æ—¶é—´åºåˆ—è¶‹åŠ¿')
        plt.xlabel('æ—¥æœŸ')
        plt.ylabel('å¹³å‡å€¼')
        plt.grid(True)
        plt.tight_layout()
        plt.savefig('timeseries.png', dpi=300)
        plt.show()

create_visualizations(df)</pre>
                    </div>
                </section>

                <section id="machine-learning">
                    <h2>ğŸ¤– æœºå™¨å­¦ä¹ å…¥é—¨</h2>

                    <h3>1. åˆ†ç±»æ¨¡å‹</h3>
                    <div class="code-block">
                        <h4>è®© Claude æ„å»ºåˆ†ç±»æ¨¡å‹ï¼š</h4>
                        <pre>
ä½ ï¼šå¸®æˆ‘æ„å»ºä¸€ä¸ªå®Œæ•´çš„åˆ†ç±»æ¨¡å‹ç®¡é“

from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import classification_report, confusion_matrix
import seaborn as sns

# å‡†å¤‡æ•°æ®
X = df.drop('target', axis=1)
y = df['target']

# åˆ†å‰²æ•°æ®é›†
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)

# è®­ç»ƒæ¨¡å‹
model = RandomForestClassifier(
    n_estimators=100,
    max_depth=10,
    random_state=42,
    n_jobs=-1
)

print("è®­ç»ƒæ¨¡å‹ä¸­...")
model.fit(X_train, y_train)

# äº¤å‰éªŒè¯
cv_scores = cross_val_score(model, X_train, y_train, cv=5)
print(f"\näº¤å‰éªŒè¯åˆ†æ•°: {cv_scores}")
print(f"å¹³å‡CVåˆ†æ•°: {cv_scores.mean():.4f} (+/- {cv_scores.std() * 2:.4f})")

# é¢„æµ‹
y_pred = model.predict(X_test)

# è¯„ä¼°
print("\nåˆ†ç±»æŠ¥å‘Š:")
print(classification_report(y_test, y_pred))

# æ··æ·†çŸ©é˜µ
cm = confusion_matrix(y_test, y_pred)
plt.figure(figsize=(8, 6))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues')
plt.title('æ··æ·†çŸ©é˜µ')
plt.ylabel('çœŸå®æ ‡ç­¾')
plt.xlabel('é¢„æµ‹æ ‡ç­¾')
plt.savefig('confusion_matrix.png')
plt.show()

# ç‰¹å¾é‡è¦æ€§
feature_importance = pd.DataFrame({
    'feature': X.columns,
    'importance': model.feature_importances_
}).sort_values('importance', ascending=False)

plt.figure(figsize=(10, 6))
sns.barplot(data=feature_importance.head(10), x='importance', y='feature')
plt.title('å‰10ä¸ªæœ€é‡è¦çš„ç‰¹å¾')
plt.tight_layout()
plt.savefig('feature_importance.png')
plt.show()</pre>
                    </div>

                    <h3>2. å›å½’æ¨¡å‹</h3>
                    <div class="code-block">
                        <h4>æ„å»ºå›å½’æ¨¡å‹ï¼š</h4>
                        <pre>
ä½ ï¼šåˆ›å»ºä¸€ä¸ªå›å½’æ¨¡å‹æ¥é¢„æµ‹æ•°å€¼

from sklearn.linear_model import Ridge
from sklearn.ensemble import GradientBoostingRegressor
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
import numpy as np

# å‡†å¤‡æ•°æ®
X = df.drop('target_value', axis=1)
y = df['target_value']

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# å°è¯•å¤šä¸ªæ¨¡å‹
models = {
    'Ridge': Ridge(alpha=1.0),
    'GradientBoosting': GradientBoostingRegressor(
        n_estimators=100,
        learning_rate=0.1,
        max_depth=3,
        random_state=42
    )
}

results = {}
for name, model in models.items():
    print(f"\nè®­ç»ƒ {name} æ¨¡å‹...")
    model.fit(X_train, y_train)
    y_pred = model.predict(X_test)

    # è¯„ä¼°
    mse = mean_squared_error(y_test, y_pred)
    rmse = np.sqrt(mse)
    mae = mean_absolute_error(y_test, y_pred)
    r2 = r2_score(y_test, y_pred)

    results[name] = {
        'MSE': mse,
        'RMSE': rmse,
        'MAE': mae,
        'RÂ²': r2
    }

    print(f"å‡æ–¹è¯¯å·® (MSE): {mse:.4f}")
    print(f"å‡æ–¹æ ¹è¯¯å·® (RMSE): {rmse:.4f}")
    print(f"å¹³å‡ç»å¯¹è¯¯å·® (MAE): {mae:.4f}")
    print(f"RÂ² åˆ†æ•°: {r2:.4f}")

# å¯è§†åŒ–é¢„æµ‹ç»“æœ
best_model = models['GradientBoosting']
y_pred = best_model.predict(X_test)

plt.figure(figsize=(10, 6))
plt.scatter(y_test, y_pred, alpha=0.5)
plt.plot([y_test.min(), y_test.max()],
         [y_test.min(), y_test.max()], 'r--', lw=2)
plt.xlabel('çœŸå®å€¼')
plt.ylabel('é¢„æµ‹å€¼')
plt.title('é¢„æµ‹å€¼ vs çœŸå®å€¼')
plt.tight_layout()
plt.savefig('prediction_vs_actual.png')
plt.show()</pre>
                    </div>
                </section>

                <section id="advanced-ml">
                    <h2>ğŸš€ é«˜çº§MLåº”ç”¨</h2>

                    <div class="code-block">
                        <h4>è¶…å‚æ•°è°ƒä¼˜ï¼š</h4>
                        <pre>
ä½ ï¼šå¸®æˆ‘ä¼˜åŒ–æ¨¡å‹çš„è¶…å‚æ•°

from sklearn.model_selection import GridSearchCV, RandomizedSearchCV
from sklearn.ensemble import RandomForestClassifier

# å®šä¹‰å‚æ•°ç½‘æ ¼
param_grid = {
    'n_estimators': [100, 200, 300],
    'max_depth': [5, 10, 15, None],
    'min_samples_split': [2, 5, 10],
    'min_samples_leaf': [1, 2, 4],
    'max_features': ['sqrt', 'log2', None]
}

# åˆ›å»ºåŸºç¡€æ¨¡å‹
rf = RandomForestClassifier(random_state=42)

# ç½‘æ ¼æœç´¢
grid_search = GridSearchCV(
    estimator=rf,
    param_grid=param_grid,
    cv=5,
    n_jobs=-1,
    verbose=2,
    scoring='accuracy'
)

print("å¼€å§‹è¶…å‚æ•°æœç´¢...")
grid_search.fit(X_train, y_train)

print(f"\næœ€ä½³å‚æ•°: {grid_search.best_params_}")
print(f"æœ€ä½³åˆ†æ•°: {grid_search.best_score_:.4f}")

# ä½¿ç”¨æœ€ä½³æ¨¡å‹
best_model = grid_search.best_estimator_
y_pred = best_model.predict(X_test)

print("\nä¼˜åŒ–åçš„æ¨¡å‹æ€§èƒ½:")
print(classification_report(y_test, y_pred))</pre>
                    </div>
                </section>

                <section id="best-practices">
                    <h2>âœ¨ æœ€ä½³å®è·µ</h2>

                    <div class="tip-box">
                        <h3>1. æ•°æ®ç§‘å­¦å·¥ä½œæµ</h3>
                        <ul>
                            <li>é—®é¢˜å®šä¹‰ â†’ æ•°æ®æ”¶é›† â†’ æ•°æ®æ¸…æ´— â†’ EDA</li>
                            <li>ç‰¹å¾å·¥ç¨‹ â†’ æ¨¡å‹é€‰æ‹© â†’ è®­ç»ƒè¯„ä¼° â†’ ä¼˜åŒ–</li>
                            <li>éƒ¨ç½²ç›‘æ§ â†’ æŒç»­æ”¹è¿›</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h3>2. ä»£ç ç»„ç»‡</h3>
                        <ul>
                            <li>ä½¿ç”¨ Jupyter Notebook è¿›è¡Œæ¢ç´¢</li>
                            <li>å°†ç¨³å®šä»£ç è½¬ç§»åˆ° .py æ–‡ä»¶</li>
                            <li>åˆ›å»ºå¯å¤ç”¨çš„å‡½æ•°å’Œç±»</li>
                            <li>ç‰ˆæœ¬æ§åˆ¶ï¼ˆGitï¼‰ç®¡ç†ä»£ç </li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h3>3. æ€§èƒ½ä¼˜åŒ–</h3>
                        <ul>
                            <li>ä½¿ç”¨å‘é‡åŒ–æ“ä½œæ›¿ä»£å¾ªç¯</li>
                            <li>åˆç†ä½¿ç”¨æ•°æ®ç±»å‹å‡å°‘å†…å­˜</li>
                            <li>å¹¶è¡Œå¤„ç†å¤§æ•°æ®é›†</li>
                            <li>ä½¿ç”¨ Dask å¤„ç†è¶…å¤§æ•°æ®</li>
                        </ul>
                    </div>
                </section>

                <section class="next-steps">
                    <h2>ğŸš€ ä¸‹ä¸€æ­¥</h2>
                    <p>ç»§ç»­æ·±å…¥å­¦ä¹ ï¼š</p>
                    <ul>
                        <li><a href="claude-code-performance.html">æ€§èƒ½ä¼˜åŒ–æŠ€å·§</a></li>
                        <li><a href="claude-code-testing.html">æµ‹è¯•é©±åŠ¨å¼€å‘</a></li>
                        <li><a href="../examples/python-data-analysis.html">æ›´å¤šæ•°æ®åˆ†æç¤ºä¾‹</a></li>
                    </ul>
                </section>
            </article>
        </div>
    </main>

    <div id="footer-placeholder"></div>

    <script src="../scripts/load-footer.js"></script>
    <script src="../scripts/wechat-share.js"></script>
</body>

</html>
